"0",""
"0","#This is a matrix of TPMs"
"0",""
"0","longitudinal_OG_TPM_mat <- pivot_wider(longitudinal_OG_counts, id_cols=OG, names_from=LIBID, "
"0","                                          values_from=TPM) %>% as.data.frame()"
"0",""
"0","longitudinal_OG_TPM_mat[is.na(longitudinal_OG_TPM_mat)] <- 0 "
"0",""
"0","rownames(longitudinal_OG_TPM_mat) <- longitudinal_OG_TPM_mat$OG"
"0",""
"0","longitudinal_OG_TPM_mat <- longitudinal_OG_TPM_mat %>% dplyr::select(-OG) %>% as.matrix()"
"0",""
"0","longitudinal_OG_TPM_pearson_mat <- cor(longitudinal_OG_TPM_mat, method=""pearson"")"
"0",""
"0",""
"0","#both upper and lower triangles represented here"
"0","longitudinal_OG_TPM_pearson_df  <- reshape2::melt(longitudinal_OG_TPM_pearson_mat, varnames = c(""row"", ""col""))"
"0","      "
"0","longitudinal_OG_TPM_pearson_df <- longitudinal_OG_TPM_pearson_df %>% dplyr::filter(col!=row)"
"0",""
"0","#comparison for selection purposes"
"0","longitudinal_OG_TPM_pearson_df$comparison <- paste0(longitudinal_OG_TPM_pearson_df$row,""-"",longitudinal_OG_TPM_pearson_df$col)"
"0",""
"0","##############################"
"0","#within individuals, same site"
"0","##############################"
"0",""
"0","within_individuals_longitudinal_OG_TPM_pearson_df <- longitudinal_OG_TPM_pearson_df %>% dplyr::filter(comparison %in% longitudinal_within_individuals_comparisons)"
"0",""
"0","median(within_individuals_longitudinal_OG_TPM_pearson_df$value) #0.897786"
"1","[1]"
"1"," 0.897786"
"1","
"
"0","##############################"
"0","#between individuals, same site"
"0","##############################"
"0",""
"0","betw_individuals_longitudinal_OG_TPM_pearson_df  <- longitudinal_OG_TPM_pearson_df  %>% dplyr::filter(comparison %in% longitudinal_betw_individuals_comparisons)"
"0",""
"0","median(betw_individuals_longitudinal_OG_TPM_pearson_df$value) #0.52296"
"1","[1]"
"1"," 0.5229617"
"1","
"
