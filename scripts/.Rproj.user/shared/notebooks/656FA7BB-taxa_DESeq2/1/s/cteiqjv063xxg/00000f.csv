"0",""
"0","metadata <- read_tsv(""../metadata/skin_mtx_metadata_fmt.txt"", show_col_types = FALSE) "
"0",""
"0","mgx_stats <- read_tsv(""../metadata/MGX_QC_stats.txt"", show_col_types = FALSE) "
"0",""
"0","mtx_stats <- read_tsv(""../metadata/MTX_QC_stats.txt"", show_col_types = FALSE) "
"0",""
"0","mgx_stats <- merge(mgx_stats, metadata, by = ""LIBID"", all.x=TRUE)"
"0",""
"0","mtx_stats <- merge(mtx_stats, metadata, by =""LIBID"", all.x=TRUE)"
"0",""
"0",""
"0","mtx_to_pull <- read_tsv(""../metadata/mtx_to_pull"", col_names = FALSE, show_col_types = FALSE) %>% pull(X1)"
"0",""
"0","mgx_to_pull <- read_tsv(""../metadata/mgx_to_pull"", col_names = FALSE, show_col_types = FALSE) %>% pull(X1)"
"0",""
"0","mtx_stats_chosen <- mtx_stats %>% dplyr::filter(LIBID %in% mtx_to_pull)"
"0",""
"0","mgx_stats_chosen <- mgx_stats %>% dplyr::filter(LIBID %in% mgx_to_pull)"
"0",""
"0","mtx_mgx_stats_chosen <- read_tsv(file=""../metadata/mtx_mgx_stats_chosen.tsv"", show_col_types = FALSE)"
"0",""
"0","##########"
"0","#MTX Library IDs per site"
"0",""
"0","mtx_Sc_ids <- mtx_mgx_stats_chosen %>% dplyr::filter(region==""Sc"") %>% pull(mtx_LIBID)"
"0","mtx_Ch_ids <- mtx_mgx_stats_chosen %>% dplyr::filter(region==""Ch"") %>% pull(mtx_LIBID)"
"0","mtx_Ac_ids <- mtx_mgx_stats_chosen %>% dplyr::filter(region==""Ac"") %>% pull(mtx_LIBID)"
"0","mtx_Vf_ids <- mtx_mgx_stats_chosen %>% dplyr::filter(region==""Vf"") %>% pull(mtx_LIBID)"
"0","mtx_Tw_ids <- mtx_mgx_stats_chosen %>% dplyr::filter(region==""Tw"") %>% pull(mtx_LIBID)"
"0",""
"0","#MGX Library IDs per site"
"0",""
"0","mgx_Sc_ids <- mtx_mgx_stats_chosen %>% dplyr::filter(region==""Sc"") %>% pull(mgx_LIBID)"
"0","mgx_Ch_ids <- mtx_mgx_stats_chosen %>% dplyr::filter(region==""Ch"") %>% pull(mgx_LIBID)"
"0","mgx_Ac_ids <- mtx_mgx_stats_chosen %>% dplyr::filter(region==""Ac"") %>% pull(mgx_LIBID)"
"0","mgx_Vf_ids <- mtx_mgx_stats_chosen %>% dplyr::filter(region==""Vf"") %>% pull(mgx_LIBID)"
"0","mgx_Tw_ids <- mtx_mgx_stats_chosen %>% dplyr::filter(region==""Tw"") %>% pull(mgx_LIBID)"
"0",""
"0","##########"
"0",""
"0","COG_categories <- read_tsv(""../metadata/eggnog_cat.txt"") %>% dplyr::rename(COG=eggnog_cat, "
"0","                                                                           COG_functional_cat=eggnog_functional_cat,"
"0","                                                                           COG_desc=cat_definition)"
"1","[1mRows: [22m[34m25[39m [1mColumns: [22m[34m3[39m
"
"1","[36mâ”€â”€[39m [1mColumn specification[22m [36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[1mDelimiter:[22m ""\t""
[31mchr[39m (3): eggnog_cat, eggnog_functional_cat, cat_definition
"
"1","
[36mâ„¹[39m Use `spec()` to retrieve the full column specification for this data.
[36mâ„¹[39m Specify the column types or set `show_col_types = FALSE` to quiet this message.
"
"0","##########"
"0","#Last pubmed search date: 24th Nov 2022"
"0",""
"0","#load disbiome and microphenoDB results for genera reported on skin, both for mgx and mtx data"
"0",""
"0","disbiome_skin_res <- read_tsv(""../metadata/mtx_contam_genera.tsv"", show_col_types = FALSE)"
"0",""
"0",""
"0",""
"0","genera_to_remove <- c(disbiome_skin_res %>% "
"0","                        filter(reported_for_skin_disease_in_disbiome == FALSE & "
"0","                                 reported_on_skin_in_microphenoDB ==FALSE &"
"0","                                 pubmed_skin_microbiome == FALSE) %>% "
"0","                        pull(name), ""Homo"", ""Listeria"", ""Plesiomonas"", ""Vibrio"") #34 candidates to remove"
"0",""
"0","genera_mask <- stringi::stri_paste(""^"",genera_to_remove, collapse=""|"")"
"0",""
"0","#Derived from sparCC correlation analysis"
"0","#In some applications, should add Homo_sapiens and unclassified to this"
"0","species_to_remove <- read_tsv(""../metadata/species_to_remove"", col_names = FALSE, show_col_types = FALSE) %>% pull(X1) #111"
"0",""
"0",""
"0","################"
"0","##For GO analysis"
"0","################"
"0",""
"0","## Load goslim_metagenome annotations"
"0",""
"0","goslim_metagenome_term2name <- read_tsv(""../metadata/goslim_metagenome.txt"", "
"0","                                    col_names = c(""GO_slim"",""GO_desc""), show_col_types = FALSE) %>% "
"0","  dplyr::rename(from=GO_slim, to=GO_desc)"
"0",""
"0",""
"0","# Load GO annotations"
"0","GO_annot_all <- read_tsv(""../metadata/all_GO_annotations.tsv"", show_col_types = FALSE)"
"0",""
"0",""
"0","#Select annotations associated with ""Biological Process"""
"0","GO_BP_term2name <- GO_annot_all %>% "
"0","  dplyr::filter(ontology==""BP"") %>% "
"0","  dplyr::select(GO_ID, GO_desc) %>%"
"0","  dplyr::rename(from=GO_ID, to=GO_desc)"
"0",""
"0",""
"0","#Select annotations associated with ""Molecular Function"""
"0","GO_MF_term2name <- GO_annot_all %>% "
"0","  dplyr::filter(ontology==""MF"") %>% "
"0","  dplyr::select(GO_ID, GO_desc) %>%"
"0","  dplyr::rename(from=GO_ID, to=GO_desc)"
"0",""
"0",""
"0","#Select annotations associated with ""Cellular Component"""
"0","GO_CC_term2name <- GO_annot_all %>% "
"0","  dplyr::filter(ontology==""CC"") %>% "
"0","  dplyr::select(GO_ID, GO_desc) %>%"
"0","  dplyr::rename(from=GO_ID, to=GO_desc)"
"0",""
"0",""
"0","#######"
"0",""
"0","#download KO pathway annotations"
"0","#https://www.genome.jp/kegg/mapper/search.html"
"0","#https://www.genome.jp/kegg-bin/show_organism?menu_type=pathway_maps&org=ko"
"0",""
"0","#ko.pathways <- download_KEGG(species=""ko"")"
"0","#term2name <- ko.pathways$KEGGPATHID2NAME"
"0","#write_tsv(term2name, file=""../metadata/KEGG_term2name.tsv"")"
"0",""
"0","#Load in term2name so that we do not have to download_KEGG every time we re-run this chunk"
"0","KEGG_term2name <- read_tsv(""../metadata/KEGG_term2name.tsv"", show_col_types = FALSE)"
"0",""
"0",""
"0",""
"0",""
"0",""
"0","###########"
"0","##Malassezia analysis files"
"0","##########"
"0",""
"0","#See 04_mh_lab_book.Rmd 12/04/2023 for how the Malassezia files were generated"
"0",""
"0","###Load Malassezia transcriptome eggNOG annotations. Also need to associate each query with a Malassezia locus tag"
"0","#This can be done with Malassezia_tx2gene"
"0",""
"0","Malassezia_OG_annot <- read_tsv(""../genomes/emapper_out/Malassezia_CDS.emapper.annotations"","
"0","                                                   comment=""#"", show_col_types = FALSE,"
"0","                                                   col_names = c(""query"",  "
"0","                                                                 ""seed_ortholog"",   "
"0","                                                              ""evalue"","
"0","                                                              ""score"","
"0","                                                              ""eggNOG_OGs"","
"0","                                                              ""max_annot_lvl"","
"0","                                                              ""COG_category"","
"0","                                                              ""Description"","
"0","                                                              ""Preferred_name"", "
"0","                                                              ""GOs"", ""EC"", ""KEGG_ko"","
"0","                                                              ""KEGG_Pathway"", ""KEGG_Module"","
"0","                                                              ""KEGG_Reaction"",  ""KEGG_rclass"","
"0","                                                              ""BRITE"", ""KEGG_TC"", "
"0","                                                              ""CAZy"", ""BiGG_Reaction"", ""PFAMs""))"
"0",""
"0",""
"0","###########"
"0","##M restricta"
"0","##########"
"0","#Malassezia restricta has good annotations from the gtf file. Transfer those labels here as well. See extract_annots.sh"
"0","#Unfortunately, M globosa does not have equally good annotations in the gtf file."
"0","#Gene is actually ""locus_tag"""
"0","M_res_gtf_annots <- read_tsv(""../metadata/M_restricta_GCA_003691605.1_ASM369160v1_cds_from_genomic_annots.tsv"", "
"0","                             col_names = c(""gene_tag"",""gene"",""proteinID""), show_col_types = FALSE)"
"0",""
"0","M_res_gtf_annots$annot <- ifelse(is.na(M_res_gtf_annots$gene_tag) & is.na(M_res_gtf_annots$proteinID), "
"0","                                 M_res_gtf_annots$gene, ifelse(is.na(M_res_gtf_annots$gene_tag)"
"0","                                                               & !is.na(M_res_gtf_annots$proteinID), "
"0","                                                               M_res_gtf_annots$proteinID, M_res_gtf_annots$gene_tag)"
"0","                                 )"
"0","M_res_gtf_annots$annot <- paste0(M_res_gtf_annots$gene,""_"",M_res_gtf_annots$annot)"
"0","#Shorten very long label"
"0","M_res_gtf_annots$annot <- gsub(pattern=""putative CDP-alcohol phosphatidyltransferase class-I family protein C22A12.10"", "
"0","                               replacement=""CDP-alcohol phosphatidyltransferase"","
"0","                               M_res_gtf_annots$annot)"
"0",""
"0",""
"0","###########"
"0","##M globosa"
"0","##########"
"0","#For salmon tximport"
"0","Malassezia_tx2gene <- read_tsv(""../metadata/Malassezia_tx2gene.tsv"", col_names = FALSE, show_col_types = FALSE) #21037 transcripts and 21025 genes"
"0",""
"0","#Add Malassezia gene annotations to the eggnog annotation file"
"0","colnames(Malassezia_tx2gene) <- c(""query"",""gene"")"
"0","Malassezia_OG_annot <- merge(Malassezia_OG_annot, Malassezia_tx2gene, all.x=TRUE, by = ""query"")"
"0",""
"0",""
"0","MGL_OG_annot <- Malassezia_OG_annot %>% dplyr::filter(str_detect(string=Malassezia_OG_annot$gene, pattern=""MGL""))"
"0","MGL_OG_annot$annot <- paste0(MGL_OG_annot$gene,""_"",MGL_OG_annot$Description)"
"0",""
"0","#Details of M globosa genes and the 13 secreted lipases"
"0","MGL_secretory_lipase <- MGL_OG_annot %>% dplyr::filter(str_detect(string=MGL_OG_annot$Description, pattern=""Secretory lipase|^Lipase""))"
"0",""
"0",""
"0","###########"
"0","##Bacteria analysis files"
"0","##########"
"0",""
"0","#####"
"0","#Load in annotations of microbial pangene clusters"
"0","S_epi_anno <- read_csv(""../genomes/1282.Staphylococcus.epidermidis.pangenome.annotation.matrix.csv"", show_col_types = FALSE) %>% dplyr::rename(propan_clusterID=Clusters)"
"0","S_epi_pangene_names <- read_tsv(""../genomes/S_epi_derep_pangenome_names.txt"", "
"0","                                col_names = ""pangene"","
"0","                                show_col_types = FALSE) #29159, derived from eight_skin_bact_pangenome_rep_names.txt"
"0",""
"0","C_acnes_anno <- read_csv(""../genomes/1747.Cutibacterium.acnes.pangenome.annotation.matrix.csv"","
"0","                         show_col_types = FALSE) %>% dplyr::rename(propan_clusterID=Clusters)"
"0","C_acnes_pangene_names <- read_tsv(""../genomes/C_acnes_derep_pangenome_names.txt"", "
"0","                                  col_names = ""pangene"","
"0","                                  show_col_types = FALSE) #9922"
"0",""
"0","S_capitis_anno <- read_csv(""../genomes/29388.Staphylococcus.capitis.pangenome.annotation.matrix.csv"","
"0","                           show_col_types = FALSE) %>% dplyr::rename(propan_clusterID=Clusters)"
"0",""
"0","S_capitis_pangene_names <- read_tsv(""../genomes/S_capitis_derep_pangenome_names.txt"", "
"0","                                    col_names = ""pangene"", show_col_types = FALSE)"
"0",""
"0","S_epidermidis_anno <- read_csv(""../genomes/1282.Staphylococcus.epidermidis.pangenome.annotation.matrix.csv"","
"0","                               show_col_types = FALSE) %>% dplyr::rename(propan_clusterID=Clusters)"
"0",""
"0","S_epidermidis_pangene_names <- read_tsv(""../genomes/S_epidermidis_derep_pangenome_names.txt"", "
"0","                                        col_names = ""pangene"","
"0","                                        show_col_types = FALSE)"
"0",""
"0","S_hominis_anno <- read_csv(""../genomes/1290.Staphylococcus.hominis.pangenome.annotation.matrix.csv"","
"0","                           show_col_types = FALSE) %>% dplyr::rename(propan_clusterID=Clusters)"
"0",""
"0","S_hominis_pangene_names <- read_tsv(""../genomes/S_hominis_derep_pangenome_names.txt"", "
"0","                                    col_names = ""pangene"","
"0","                                    show_col_types = FALSE)"
"0",""
"0","#Load emapper annotations for the eight skin bacteria (for species specific analysis)"
"0","#See 04_mh_lab_book.Rmd, 04/12/2023 for how the eight skin bact results were generated"
"0",""
"0","eight_skin_bact_proteins_emapper_annot <- read_tsv(""../genomes/emapper_out/eight_skin_bact_proteins.emapper.annotations"","
"0","                                                   comment=""#"", show_col_types = FALSE,"
"0","                                                   col_names = c(""query"",  "
"0","                                                                 ""seed_ortholog"",   "
"0","                                                              ""evalue"","
"0","                                                              ""score"","
"0","                                                              ""eggNOG_OGs"","
"0","                                                              ""max_annot_lvl"","
"0","                                                              ""COG_category"","
"0","                                                              ""Description"","
"0","                                                              ""Preferred_name"", "
"0","                                                              ""GOs"", ""EC"", ""KEGG_ko"","
"0","                                                              ""KEGG_Pathway"", ""KEGG_Module"","
"0","                                                              ""KEGG_Reaction"",  ""KEGG_rclass"","
"0","                                                              ""BRITE"", ""KEGG_TC"", "
"0","                                                              ""CAZy"", ""BiGG_Reaction"", ""PFAMs""))"
"0",""
"0",""
"0",""
"0","eight_skin_bact_proteins_emapper_annot$species <- word(eight_skin_bact_proteins_emapper_annot$query,1,2,sep=""_"")"
"0",""
"0","eight_skin_bact_proteins_emapper_annot$propan_clusterID <- word(eight_skin_bact_proteins_emapper_annot$query,3,4,sep=""_"")"
"0","  "
