"0","#Shape the data to appropriate form"
"0",""
"0","rna_kraken_longitudinal_renorm_df <- do.call(""rbind"",rna_kraken_longitudinal_renorm) "
"0",""
"0","rna_kraken_longitudinal_renorm_df <- rna_kraken_longitudinal_renorm_df %>% dplyr::select(mtx_LIBID,k2_taxon,rel_abun)"
"0",""
"0","rna_kraken_longitudinal_abun_table <- pivot_wider(rna_kraken_longitudinal_renorm_df, id_cols=k2_taxon, names_from=mtx_LIBID, "
"0","                                          values_from=rel_abun) %>% as.data.frame()"
"0",""
"0",""
"0","rna_kraken_longitudinal_abun_table[is.na(rna_kraken_longitudinal_abun_table )] <- 0 "
"0",""
"0","rownames(rna_kraken_longitudinal_abun_table) <- rna_kraken_longitudinal_abun_table$k2_taxon"
"0",""
"0","#for bcdist, rows must be samples and columns must be species, so we need to transpose"
"0","rna_kraken_longitudinal_BC_dist <- ecodist::bcdist(t(rna_kraken_longitudinal_abun_table %>% dplyr::select(-k2_taxon))) %>% as.matrix()"
"0",""
"0","#both upper and lower triangles represented here"
"0","rna_kraken_longitudinal_BC_dist  <- reshape2::melt(rna_kraken_longitudinal_BC_dist, varnames = c(""row"", ""col""))"
"0","      "
"0","rna_kraken_longitudinal_BC_dist <- rna_kraken_longitudinal_BC_dist %>% dplyr::filter(col!=row)"
"0",""
"0","#comparison for selection purposes"
"0","rna_kraken_longitudinal_BC_dist$comparison <- paste0(rna_kraken_longitudinal_BC_dist$row,""-"",rna_kraken_longitudinal_BC_dist$col)"
"0",""
"0","##############################"
"0","#within individuals, same site"
"0","##############################"
"0",""
"0","within_individuals_RNA_longitudinal_BC_dist <- rna_kraken_longitudinal_BC_dist %>% dplyr::filter(comparison %in% longitudinal_within_individuals_comparisons)"
"0",""
"0","median(within_individuals_RNA_longitudinal_BC_dist$value) #0.23"
"1","[1]"
"1"," 0.2313566"
"1","
"
"0","##############################"
"0","#between individuals, same site"
"0","##############################"
"0",""
"0","betw_individuals_RNA_longitudinal_BC_dist <- rna_kraken_longitudinal_BC_dist %>% dplyr::filter(comparison %in% longitudinal_betw_individuals_comparisons)"
"0",""
"0","median(betw_individuals_RNA_longitudinal_BC_dist$value) #0.622"
"1","[1]"
"1"," 0.6226658"
"1","
"
